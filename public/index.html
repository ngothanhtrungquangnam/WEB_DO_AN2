<!DOCTYPE html>
<html lang="vi">
<head>
ย ย <meta charset="UTF-8">
ย ย <meta name="viewport" content="width=device-width, initial-scale=1.0">
ย ย <title>Quรกn ฤn Ngon 24h</title>
ย ย <link rel="stylesheet" href="style.css">
    <script src="/socket.io/socket.io.js"></script>
</head>

<body>
ย ย <div id="toastMessage" class="toast"></div>
ย ย 
ย ย <div id="navbar-placeholder"></div>

ย ย <section class="controls">
ย ย ย ย <input type="text" id="searchBox" placeholder="๐ Tรฌm mรณn ฤn...">
ย ย ย ย <select id="categoryFilter">
ย ย ย ย ย ย <option value="all">Tแบฅt cแบฃ</option>
ย ย ย ย ย ย <option value="Mรณn nฦฐแปc">Mรณn nฦฐแปc</option>
ย ย ย ย ย ย <option value="Mรณn khรด">Mรณn khรด</option>
ย ย ย ย ย ย <option value="Nฦฐแปc uแปng">Nฦฐแปc uแปng</option>
ย ย ย ย </select>
ย ย </section>

ย ย <section class="menu">
ย ย ย ย <div id="menuContainer" class="menu-grid">
ย ย ย ย ย ย ย ย ย ย </div>
ย ย </section>
ย ย 
ย ย <section id="payment" class="section" style="display:none;">
ย ย ย ย <h2>๐ณ Thanh toรกn</h2>
ย ย ย ย <p>Chฦฐa cรณ thรดng tin thanh toรกn.</p>
ย ย </section>

ย ย <section id="profile" class="section" style="display:none;">
ย ย ย ย <h2>๐ค Thรดng tin ngฦฐแปi dรนng</h2>
ย ย ย ย <p>ฤฤng nhแบญp ฤแป xem thรดng tin cรก nhรขn cแปงa bแบกn.</p>
ย ย </section>

ย ย <footer>
ย ย ย ย <p>ยฉ 2025 Quรกn ฤn Ngon 24h</p>
ย ย </footer>

ย ย ย ย <script>
ย ย ย ย // === BIแบพN GLOBAL ===
ย ย ย ย let userInfo = null; 

ย ย ย ย // === CรC HรM Cลจ CแปฆA BแบN (GIแปฎ NGUYรN) ===
ย ย ย ย function showSection(id) {
ย ย ย ย ย ย document.querySelectorAll('#history, #payment, #profile').forEach(sec => sec.style.display = 'none');
ย ย ย ย ย ย const activeSection = document.getElementById(id);
ย ย ย ย ย ย if (activeSection) {
ย ย ย ย ย ย ย ย activeSection.style.display = 'block';
ย ย ย ย ย ย }
ย ย ย ย ย ย window.scrollTo({ top: 0, behavior: 'smooth' });
ย ย ย ย }

ย ย ย ย function runIndexPageLogic() {
ย ย ย ย ย ย const utilityDropdown = document.getElementById("utilityDropdown");
ย ย ย ย ย ย if (utilityDropdown) {
ย ย ย ย ย ย ย ย if (userInfo) {
ย ย ย ย ย ย ย ย ย ย utilityDropdown.style.display = "inline-block";
ย ย ย ย ย ย ย ย } else {
ย ย ย ย ย ย ย ย ย ย utilityDropdown.style.display = "none";
ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย }

ย ย ย ย ย ย const authButton = document.getElementById("authButton");
ย ย ย ย ย ย const navOrderLink = document.getElementById("nav-order-link");
ย ย ย ย ย ย const navAdminLink = document.getElementById("nav-admin-link");

ย ย ย ย ย ย if (authButton && navOrderLink && navAdminLink) { 
ย ย ย ย ย ย ย ย if (userInfo) {
ย ย ย ย ย ย ย ย ย ย authButton.textContent = "ฤฤng xuแบฅt";
ย ย ย ย ย ย ย ย ย ย if (userInfo.role === "admin") {
ย ย ย ย ย ย ย ย ย ย ย ย navOrderLink.style.display = "none";
ย ย ย ย ย ย ย ย ย ย ย ย navAdminLink.style.display = "inline-block";
ย ย ย ย ย ย ย ย ย ย } else {
ย ย ย ย ย ย ย ย ย ย ย ย navOrderLink.style.display = "inline-block";
ย ย ย ย ย ย ย ย ย ย ย ย navAdminLink.style.display = "none";
ย ย ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย ย ย ย ย authButton.addEventListener("click", () => {
ย ย ย ย ย ย ย ย ย ย ย ย localStorage.removeItem("userInfo");
ย ย ย ย ย ย ย ย ย ย ย ย window.location.href = "/index.html";
ย ย ย ย ย ย ย ย ย ย });
ย ย ย ย ย ย ย ย } else {
ย ย ย ย ย ย ย ย ย ย authButton.textContent = "ฤฤng nhแบญp";
ย ย ย ย ย ย ย ย ย ย navOrderLink.style.display = "none";
ย ย ย ย ย ย ย ย ย ย navAdminLink.style.display = "none";
ย ย ย ย ย ย ย ย ย ย authButton.addEventListener("click", () => {
ย ย ย ย ย ย ย ย ย ย ย ย window.location.href = "/login.html";
ย ย ย ย ย ย ย ย ย ย });
ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย } else {
ย ย ย ย ย ย ย ย console.error("Lแปi: Khรดng tรฌm thแบฅy cรกc nรบt ฤiแปu khiแปn header!");
ย ย ย ย ย ย }
ย ย ย ย }

ย ย ย ย // === CODE "LแบฎP RรP" MแปI (GIแปฎ NGUYรN) ===
ย ย ย ย document.addEventListener("DOMContentLoaded", () => {
ย ย ย ย ย ย userInfo = JSON.parse(localStorage.getItem("userInfo")); // Gรกn giรก trแป cho biแบฟn global

ย ย ย ย ย ย // Quyแบฟt ฤแปnh file navbar cแบงn tแบฃi dแปฑa trรชn vai trรฒ
ย ย ย ย ย ย let navbarFile = '/user-navbar.html'; // Mแบทc ฤแปnh lร user
ย ย ย ย ย ย if (userInfo && userInfo.role === 'admin') {
ย ย ย ย ย ย ย ย navbarFile = '/admin-navbar.html'; // Nแบฟu lร admin thรฌ ฤแปi file
ย ย ย ย ย ย }
ย ย ย ย ย ย 
ย ย ย ย ย ย // Bแบฏt ฤแบงu tแบฃi file navbar tฦฐฦกng แปฉng
ย ย ย ย ย ย fetch(navbarFile)
ย ย ย ย ย ย ย ย .then(response => {
ย ย ย ย ย ย ย ย ย ย if (!response.ok) throw new Error(`Khรดng tรฌm thแบฅy file ${navbarFile}`);
ย ย ย ย ย ย ย ย ย ย return response.text();
ย ย ย ย ย ย ย ย })
ย ย ย ย ย ย ย ย .then(data => {
ย ย ย ย ย ย ย ย ย ย // 1. Lแบฏp menu vรo
ย ย ย ย ย ย ย ย ย ย const navbarPlaceholder = document.getElementById('navbar-placeholder');
ย ย ย ย ย ย ย ย ย ย if (navbarPlaceholder) {
ย ย ย ย ย ย ย ย ย ย ย ย navbarPlaceholder.innerHTML = data;
ย ย ย ย ย ย ย ย ย ย } else {
ย ย ย ย ย ย ย ย ย ย ย ย console.error("Khรดng tรฌm thแบฅy thแบป #navbar-placeholder!");
ย ย ย ย ย ย ย ย ย ย ย ย return; 
ย ย ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย ย ย ย ย 
ย ย ย ย ย ย ย ย ย ย // 2. Chแบกy logic cแปงa trang (hรm runIndexPageLogic ฤรฃ cรณ แป trรชn)
ย ย ย ย ย ย ย ย ย ย if (typeof runIndexPageLogic === 'function') {
ย ย ย ย ย ย ย ย ย ย ย ย runIndexPageLogic(); 
ย ย ย ย ย ย ย ย ย ย } else {
ย ย ย ย ย ย ย ย ย ย ย ย ยconsole.error("Khรดng tรฌm thแบฅy hรm runIndexPageLogic()!");
ย ย ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย ย ย })
ย ย ย ย ย ย ย ย .catch(error => {
ย ย ย ย ย ย ย ย ย ย console.error('Lแปi tแบฃi menu:', error);
ย ย ย ย ย ย ย ย ย ย const navbarPlaceholder = document.getElementById('navbar-placeholder');
ย ย ย ย ย ย ย ย ย ย ยif (navbarPlaceholder) {
ย ย ย ย ย ย ย ย ย ย ย ย ยnavbarPlaceholder.innerHTML = `<p style="color:red; text-align:center;">LแปI TแบขI MENU (${error.message})</p>`;
ย ย ย ย ย ย ย ย ย ย ย}
ย ย ย ย ย ย ย ย });
ย ย ย ย });
ย ย </script>

ย ย ย ย <script src="script.js" defer></script> 
ย ย <script src="data.js" defer></script> 
ย ย 
ย ย ย ย ย ย <script src="/socket.io/socket.io.js"></script>
ย ย ย ย <script src="js/chatbox.js"></script>

</body>
</html>