<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuÃ¡n Ä‚n Ngon 24h</title>
    
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    
    <script src="/socket.io/socket.io.js"></script>

    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
      import { 
            getAuth, 
            GoogleAuthProvider, 
            RecaptchaVerifier, 
            signInWithPhoneNumber,
            signInWithPopup,
            signInWithRedirect,  
            getRedirectResult    
        } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

      const firebaseConfig = { 
        apiKey : "AIzaSyBYSPBbU7Bvwr0NqSEe8QbRhV9isZiqXMU" , 
        authDomain : "quan-an-ngon-24h.firebaseapp.com" , 
        projectId : "quan-an-ngon-24h" , 
        storageBucket : "quan-an-ngon-24h.firebasestorage.app" , 
        messagingSenderId : "278494088500" , 
        appId : "1:278494088500:web:1b8ceae987e7a3358d2961" 
      };

      // Khá»Ÿi táº¡o Firebase
      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      
      // GÃ¡n vÃ o biáº¿n window Ä‘á»ƒ file script.js dÃ¹ng Ä‘Æ°á»£c
      window.firebaseAuth = auth;
      window.GoogleAuthProvider = GoogleAuthProvider;
      window.signInWithPopup = signInWithPopup;
      window.RecaptchaVerifier = RecaptchaVerifier;
      window.signInWithPhoneNumber = signInWithPhoneNumber;
      window.signInWithRedirect = signInWithRedirect;
      window.getRedirectResult = getRedirectResult;
      
      console.log("âœ… Firebase Ä‘Ã£ khá»Ÿi táº¡o thÃ nh cÃ´ng!");
    </script>
<div id="bottom-nav-placeholder"></div>

<body>
Â  Â  <div id="toastMessage" class="toast"></div>
Â  Â  
Â  Â  <div id="navbar-placeholder"></div>

<section class="hero-banner">
    <div class="banner-content">
        <h2>HÃ´m nay báº¡n muá»‘n Äƒn gÃ¬?</h2>
        <p>Deal há»i giÃ¡ sá»‘c - Freeship 0Ä‘</p>
        
        <div class="search-wrapper">
            <i class="bi bi-search"></i>
            <input type="text" id="searchBox" placeholder="TÃ¬m tÃªn mÃ³n Äƒn, trÃ  sá»¯a...">
        </div>
    </div>
</section>

<section class="category-scroll">
    <div class="cat-item active" onclick="filterByCategory('all', this)">
        <div class="cat-icon"><i class="bi bi-grid-fill"></i></div>
        <span>Táº¥t cáº£</span>
    </div>
    
    <div class="cat-item" onclick="filterByCategory('MÃ³n nÆ°á»›c', this)">
        <div class="cat-icon">ğŸœ</div>
        <span>MÃ³n nÆ°á»›c</span>
    </div>

    <div class="cat-item" onclick="filterByCategory('MÃ³n khÃ´', this)">
        <div class="cat-icon">ğŸ›</div>
        <span>CÆ¡m/KhÃ´</span>
    </div>

    <div class="cat-item" onclick="filterByCategory('NÆ°á»›c uá»‘ng', this)">
        <div class="cat-icon">ğŸ¥¤</div>
        <span>Äá»“ uá»‘ng</span>
    </div>
</section>
<section class="section-container flash-sale-section">
    <div class="section-header">
        <div class="header-title">
            <i class="bi bi-lightning-charge-fill" style="color: #ffc107;"></i>
            <h2>Flash Sale</h2>
            <div class="countdown-timer">
                <span>02</span>:<span>15</span>:<span>30</span>
            </div>
        </div>
        <a href="#" class="view-all">Xem táº¥t cáº£ ></a>
    </div>

    <div class="horizontal-scroll">
        <p style="padding: 20px; color: #888;">Äang táº£i deal sá»‘c...</p>
    </div>
    </section>
<section class="section-container promo-banners">
    <div class="promo-item" style="background-image: linear-gradient(to right, #ff9a9e, #fad0c4);">
        <div class="promo-text">
            <h3>FREESHIP</h3>
            <p>ÄÆ¡n tá»« 0Ä‘</p>
        </div>
        <img src="https://cdn-icons-png.flaticon.com/512/3081/3081309.png" class="promo-img">
    </div>
    
    <div class="promo-item" style="background-image: linear-gradient(to right, #a18cd1, #fbc2eb);">
        <div class="promo-text">
            <h3>GIáº¢M 50%</h3>
            <p>Láº§n Ä‘áº§u Ä‘áº·t</p>
        </div>
        <img src="https://cdn-icons-png.flaticon.com/512/726/726476.png" class="promo-img">
    </div>

    <div class="promo-item" style="background-image: linear-gradient(to right, #84fab0, #8fd3f4);">
        <div class="promo-text">
            <h3>HOÃ€N XU</h3>
            <p>Tá»‘i Ä‘a 10k</p>
        </div>
        <img src="https://cdn-icons-png.flaticon.com/512/2489/2489756.png" class="promo-img">
    </div>
</section>
Â  Â  <section class="menu">
Â  Â  Â  Â  <div id="menuContainer" class="menu-grid">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  </section>
Â  Â  
Â  Â  <section id="payment" class="section" style="display:none;">
Â  Â  Â  Â  <h2>ğŸ’³ Thanh toÃ¡n</h2>
Â  Â  Â  Â  <p>ChÆ°a cÃ³ thÃ´ng tin thanh toÃ¡n.</p>
Â  Â  </section>

Â  Â  <section id="profile" class="section" style="display:none;">
Â  Â  Â  Â  <h2>ğŸ‘¤ ThÃ´ng tin ngÆ°á»i dÃ¹ng</h2>
Â  Â  Â  Â  <p>ÄÄƒng nháº­p Ä‘á»ƒ xem thÃ´ng tin cÃ¡ nhÃ¢n cá»§a báº¡n.</p>
Â  Â  </section>

<footer class="modern-footer">
    <div class="footer-content">
        <div class="footer-col brand-info">
            <h3>QuÃ¡n Ä‚n Ngon 24h</h3>
            <p>HÆ°Æ¡ng vá»‹ chuáº©n cÆ¡m máº¹ náº¥u. Giao hÃ ng 30 phÃºt.</p>
            <div class="social-links">
                <a href="#"><i class="bi bi-facebook"></i></a>
                <a href="#"><i class="bi bi-youtube"></i></a>
            </div>
        </div>

        <div class="footer-links-group">
            <a href="#">Vá» chÃºng tÃ´i</a>
            <a href="#">Thá»±c Ä‘Æ¡n</a>
            <a href="#">Khuyáº¿n mÃ£i</a>
            <a href="#">Trá»£ giÃºp</a>
            <a href="#">Báº£o máº­t</a>
        </div>
    </div>
    <div class="footer-bottom">
        <p>&copy; 2025 QuÃ¡n Ä‚n Ngon 24h. All rights reserved.</p>
    </div>
</footer>
<div id="auth-modal" class="auth-overlay" style="display: none;">
        <div class="auth-container" id="auth-container">
            
           <div class="form-container sign-up-container">
                <form id="form-signup">
                    <h1 class="form-title">Táº¡o tÃ i khoáº£n</h1>
                    
                    <input type="email" id="signup-email" placeholder="Email" required />
                    <input type="password" id="signup-password" placeholder="Máº­t kháº©u" required />
                    <input type="password" id="signup-confirm" placeholder="Nháº­p láº¡i máº­t kháº©u" required />
                    
                    <button type="submit">ÄÄƒng KÃ½</button>

                    <div class="social-divider">
                        <span>Hoáº·c Ä‘Äƒng kÃ½ báº±ng</span>
                    </div>
                    <div class="social-container">
                        <a href="#" class="social google" title="Google"><i class="bi bi-google"></i></a>
                        <a href="#" class="social phone" title="Sá»‘ Ä‘iá»‡n thoáº¡i"><i class="bi bi-telephone-fill"></i></a>
                    </div>
                    <p class="mobile-switch-text">
    ÄÃ£ cÃ³ tÃ i khoáº£n? <a href="#" id="signInMobile">ÄÄƒng nháº­p ngay</a>
</p>
                </form>
            </div>

            <div class="form-container sign-in-container">
                <form id="form-login">
                    <h1 class="form-title">ÄÄƒng nháº­p</h1>
                    
                    <input type="text" id="login-username" placeholder="Email hoáº·c TÃªn Ä‘Äƒng nháº­p" required />
                    <input type="password" id="login-password" placeholder="Máº­t kháº©u" required />
                   <div class="forgot-pass-wrapper">
                         <a href="#" onclick="openForgotModal()">QuÃªn máº­t kháº©u?</a>
                 </div>
                    
                    <button type="submit">ÄÄƒng Nháº­p</button>

                    <div class="social-divider">
                        <span>Hoáº·c tiáº¿p tá»¥c vá»›i</span>
                    </div>
                    <div class="social-container">
                        <a href="#" class="social google" title="Google"><i class="bi bi-google"></i></a>
                        <a href="#" class="social phone" title="Sá»‘ Ä‘iá»‡n thoáº¡i"><i class="bi bi-telephone-fill"></i></a>
                    </div>
                    <p class="mobile-switch-text">
    ChÆ°a cÃ³ tÃ i khoáº£n? <a href="#" id="signUpMobile">ÄÄƒng kÃ½ ngay</a>
</p>
                </form>
            </div>

            <div class="overlay-container">
                <div class="overlay">
                    <div class="overlay-panel overlay-left">
                        <h1>ChÃ o báº¡n cÅ©!</h1>
                        <p>Náº¿u báº¡n Ä‘Ã£ cÃ³ tÃ i khoáº£n, hÃ£y Ä‘Äƒng nháº­p Ä‘á»ƒ tiáº¿p tá»¥c Ä‘áº·t mÃ³n nhÃ©.</p>
                        <button class="ghost" id="signInBtn">ÄÄƒng Nháº­p</button>
                    </div>
                    <div class="overlay-panel overlay-right">
                        <h1>KhÃ¡ch hÃ ng má»›i?</h1>
                        <p>ÄÄƒng kÃ½ ngay Ä‘á»ƒ tÃ­ch Ä‘iá»ƒm vÃ  nháº­n Æ°u Ä‘Ã£i tá»« QuÃ¡n Ä‚n Ngon 24h.</p>
                        <button class="ghost" id="signUpBtn">ÄÄƒng KÃ½</button>
                    </div>
                </div>
                <button id="close-auth-modal" style="position: absolute; top: 20px; right: 20px; background: none; border: none; font-size: 2rem; color: white; cursor: pointer; z-index: 100;">&times;</button>
            </div>
            <div id="phone-login-form" style="display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 200; flex-direction: column; align-items: center; justify-content: center; padding: 20px;">
            
            <button id="back-to-email" style="position: absolute; top: 15px; left: 15px; border: none; background: none; font-size: 1.5rem; cursor: pointer; color: #333;">
                <i class="bi bi-arrow-left"></i> Quay láº¡i
            </button>
            
            <h1 style="color: #ff7043; margin-bottom: 20px; font-weight: bold; font-size: 1.8rem;">ÄÄƒng nháº­p SÄT</h1>
            
            <div id="step-1-phone" style="width: 100%; max-width: 320px; text-align: center;">
                <p style="margin-bottom: 15px; color: #666;">Nháº­p sá»‘ Ä‘iá»‡n thoáº¡i cá»§a báº¡n (VD: +849...)</p>
                
                <input type="text" id="phone-number-input" placeholder="+84 999 999 999" 
                       style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; margin-bottom: 15px; outline: none; background: #f9f9f9;">
                
                <div id="recaptcha-container" style="margin-bottom: 15px; display: flex; justify-content: center;"></div>
                
                <button id="btn-send-otp" style="background: #ff7043; color: white; border: none; padding: 12px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; width: 100%;">
                    Gá»­i mÃ£ OTP
                </button>
            </div>

            <div id="step-2-otp" style="display: none; width: 100%; max-width: 320px; text-align: center;">
                <p style="margin-bottom: 15px; color: #666;">Nháº­p mÃ£ 6 sá»‘ vá»«a gá»­i tá»›i Ä‘iá»‡n thoáº¡i</p>
                
                <input type="text" id="otp-input" placeholder="123456" maxlength="6"
                       style="width: 100%; padding: 15px; border: 1px solid #ddd; border-radius: 8px; margin-bottom: 20px; text-align: center; letter-spacing: 8px; font-size: 1.5rem; font-weight: bold; outline: none;">
                
                <button id="btn-verify-otp" style="background: #28a745; color: white; border: none; padding: 12px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; width: 100%;">
                    XÃ¡c thá»±c & ÄÄƒng nháº­p
                </button>
            </div>
        </div>
        </div>
    </div>
<div id="password-setup-modal" class="auth-overlay" style="display: none; justify-content: center; align-items: center; z-index: 99999;">
    <div class="auth-container" style="position: relative; max-width: 400px; width: 90%; padding: 30px; text-align: center; background: white; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); pointer-events: auto;">
        
        <span id="close-setup-btn" 
              onclick="document.getElementById('password-setup-modal').style.display='none'"
              style="position: absolute; top: 5px; right: 5px; font-size: 35px; cursor: pointer; color: #333; padding: 10px; line-height: 1; z-index: 100;">&times;</span>

        <h2 style="color: #ff7043; margin-bottom: 20px;">ğŸ”’ Thiáº¿t Láº­p Máº­t Kháº©u</h2>
        <p style="margin-bottom: 25px; font-size: 14px; color: #555;">
            Vui lÃ²ng táº¡o máº­t kháº©u cho tÃ i khoáº£n <strong id="setup-email-display">...</strong> Ä‘á»ƒ báº¡n cÃ³ thá»ƒ Ä‘Äƒng nháº­p báº±ng email/máº­t kháº©u sau nÃ y.
        </p>
        
        <form id="form-setup-password">
            <input type="password" id="setup-password-input" placeholder="Máº­t kháº©u má»›i (Ã­t nháº¥t 6 kÃ½ tá»±)" 
                   style="width: 100%; padding: 12px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 5px; box-sizing: border-box;">
            
            <input type="password" id="setup-confirm-input" placeholder="Nháº­p láº¡i máº­t kháº©u má»›i"
                   style="width: 100%; padding: 12px; margin-bottom: 20px; border: 1px solid #ddd; border-radius: 5px; box-sizing: border-box;">

            <button type="button" onclick="submitPasswordSetup()" 
                    style="width: 100%; padding: 12px; background: #ff7043; color: white; border: none; border-radius: 5px; font-weight: bold; cursor: pointer;"> 
                HoÃ n táº¥t & ÄÄƒng nháº­p
            </button>
            
            <p style="margin-top: 20px; font-size: 14px;">
                <a href="javascript:void(0)" id="skip-setup-btn" 
                   onclick="document.getElementById('password-setup-modal').style.display='none'"
                   style="color: #666; text-decoration: underline; padding: 10px; display: inline-block;">
                   Bá» qua bÆ°á»›c nÃ y
                </a>
            </p>
        </form>
    </div>
</div>
<div id="forgot-password-modal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close-btn" onclick="closeForgotModal()">&times;</span>
        
        <div id="forgot-step-1">
            <h2 style="color: #e67e22;">ğŸ”‘ QuÃªn Máº­t Kháº©u</h2>
            <p>Nháº­p email Ä‘á»ƒ nháº­n mÃ£ xÃ¡c thá»±c (OTP).</p>
            
            <input type="email" id="forgot-email" placeholder="VÃ­ dá»¥: abc@gmail.com" style="width: 100%; padding: 10px; margin: 10px 0;">
            
            <button type="button" class="btn" onclick="handleSendOtp()">Gá»­i MÃ£ OTP</button>
        </div>

<div id="forgot-step-2" style="display: none;">

            <h2 style="color: #27ae60;">âœ… ÄÃ£ gá»­i mÃ£!</h2>

            <p>Kiá»ƒm tra email vÃ  nháº­p thÃ´ng tin:</p>

           

            <input type="text" id="reset-otp" placeholder="MÃ£ OTP (6 sá»‘)" style="width: 100%; padding: 10px; margin-bottom: 5px;">

            <input type="password" id="reset-new-pass" placeholder="Máº­t kháº©u má»›i" style="width: 100%; padding: 10px;">

           

            <button type="button" class="btn" style="margin-top: 15px;" onclick="handleSubmitReset()">Äá»•i Máº­t Kháº©u</button>

           

            <p style="margin-top: 10px; cursor: pointer; color: blue;" onclick="backToStep1()">Nháº­p sai email? Quay láº¡i</p>

        </div>

    </div>

</div>




Â  Â <script>
    // === BIáº¾N GLOBAL ===
    let userInfo = null; 

    // === HÃ€M Xá»¬ LÃ LOGIC HIá»‚N THá»Š MENU ===
    function runIndexPageLogic() {
        // 1. Láº¥y thÃ´ng tin user
        userInfo = JSON.parse(localStorage.getItem("userInfo"));

        // --- A. Xá»¬ LÃ CÃC NÃšT TRÃŠN MENU ---
        const utilityDropdown = document.getElementById("utilityDropdown"); // NÃºt Tiá»‡n Ã­ch
        const navOrderLink = document.getElementById("nav-order-link");   // NÃºt Äáº·t mÃ³n
        const navAdminLink = document.getElementById("nav-admin-link");   // NÃºt Quáº£n lÃ½ (Admin)

        if (!userInfo) {
            // === TRÆ¯á»œNG Há»¢P 1: CHÆ¯A ÄÄ‚NG NHáº¬P (KHÃCH) ===
            // Chá»‰ hiá»‡n Trang chá»§ (máº·c Ä‘á»‹nh HTML Ä‘Ã£ hiá»‡n), áº¨N háº¿t cÃ¡i khÃ¡c
            if (utilityDropdown) utilityDropdown.style.display = "none";
            if (navOrderLink) navOrderLink.style.display = "none";
            if (navAdminLink) navAdminLink.style.display = "none";
        } else {
            // === TRÆ¯á»œNG Há»¢P 2: ÄÃƒ ÄÄ‚NG NHáº¬P ===
            
            // 1. Hiá»‡n "Tiá»‡n Ã­ch" cho má»i ngÆ°á»i Ä‘Ã£ Ä‘Äƒng nháº­p
            if (utilityDropdown) utilityDropdown.style.display = "inline-block";

            // 2. Hiá»‡n "Äáº·t mÃ³n" (Chá»‰ hiá»‡n cho User thÆ°á»ng, Admin thÃ¬ áº©n náº¿u muá»‘n)
            if (navOrderLink) {
                if (userInfo.role === 'admin') {
                    navOrderLink.style.display = "none"; // Admin khÃ´ng cáº§n Ä‘áº·t mÃ³n
                } else {
                    navOrderLink.style.display = "inline-block"; // User thÆ°á»ng thÃ¬ hiá»‡n
                }
            }

            // 3. Hiá»‡n "Quáº£n lÃ½" (Chá»‰ cho Admin)
            if (navAdminLink) {
                if (userInfo.role === 'admin') {
                    navAdminLink.style.display = "inline-block";
                } else {
                    navAdminLink.style.display = "none";
                }
            }
        }

        // --- B. Xá»¬ LÃ NÃšT ÄÄ‚NG NHáº¬P/TÃŠN USER ---
        const authButton = document.getElementById("authButton");
        if (authButton) {
            if (userInfo) {
                // ÄÃ£ Ä‘Äƒng nháº­p -> Hiá»‡n tÃªn & link tá»›i Profile
                authButton.textContent = `ChÃ o, ${userInfo.username}`;
                authButton.href = "/profile"; 
            } else {
                // ChÆ°a Ä‘Äƒng nháº­p -> Hiá»‡n chá»¯ ÄÄƒng nháº­p
                authButton.textContent = "ÄÄƒng nháº­p";
                authButton.href = "#"; 
            }
        }
    }

   // === KHá»I Táº O TRANG ===
document.addEventListener("DOMContentLoaded", () => {
    userInfo = JSON.parse(localStorage.getItem("userInfo")); 

    // Sá»¬A Láº I ÄOáº N NÃ€Y Äá»‚ Náº P ÄÃšNG FILE GUEST
    let navbarFile;
    if (!userInfo) {
        navbarFile = 'guest-navbar.html'; // Náº¿u chÆ°a Ä‘Äƒng nháº­p -> Náº¡p guest
    } else if (userInfo.role === 'admin') {
        navbarFile = 'admin-navbar.html'; // Náº¿u lÃ  admin
    } else {
        navbarFile = 'user-navbar.html';  // Náº¿u lÃ  user thÆ°á»ng
    }

    fetch(navbarFile)
        .then(response => {
            if (!response.ok) throw new Error(`KhÃ´ng tÃ¬m tháº¥y file ${navbarFile}`);
            return response.text();
        })
        .then(data => {
            const navbarPlaceholder = document.getElementById('navbar-placeholder');
            if (navbarPlaceholder) {
                navbarPlaceholder.innerHTML = data;
                runIndexPageLogic(); 
            }
        })
        .catch(error => console.error('Lá»—i táº£i menu:', error));
});
</script>

Â  Â  Â  Â  <script src="script.js" defer></script> 
Â  Â 
Â  Â  
Â  Â 

<script src="/js/aiChat.js"></script>

</body>
</html>